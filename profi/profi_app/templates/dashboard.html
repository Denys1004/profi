<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,200;0,300;0,400;0,600;0,700;0,800;0,900;1,200;1,300;1,400;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Righteous&display=swap" rel="stylesheet">
    <title>Home</title>
    <link href="https://fonts.googleapis.com/css2?family=Trade+Winds&display=swap" rel="stylesheet">
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <script defer src="https://code.jquery.com/jquery-3.5.1.js" integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc=" crossorigin="anonymous"></script>
    <script defer src="{% static 'js/main.js' %}"></script>
</head>
<body>
    {% include 'navbar.html' %}


    <div class="dashboard_page_container">

        <div class="display_flex">
            <h1>Hello {{ cur_user.first_name }}!</h1>
            <a class="btn btn-warning" href="/create_new_job">New job</a>
        </div>
        <hr>
        <h3>All {{ cur_user.first_name }}'s jobs!</h3>
        <table class="table table-bordered mt-1">
            <thead class="thead-dark">
                <tr>
                    <th>Job</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                {% for job in all_jobs %}
                    {% if job.executor != null and job.executor.id == request.session.user_id %}
                    <!-- if logged user doing this job, display this -->
                    <tr>
                        <td>{{ job.title }}</td>
                        <td>
                            <a href="view/{{job.id}}">View | </a> 
                            <a href="done_job/{{job.id}}">Done |</a>  
                            <a href="giveup_job/{{job.id}}">GiveUp</a>
                        </td>                        
                    </tr>
                    {% endif%}
                {% endfor %}
            </tbody>
        </table>
        <h3>Everyone's jobs</h3>
        <table class="table table-bordered mt-1">
            <thead class="thead-dark">
                <tr>
                    <th>Posted</th>
                    <th>Job</th>
                    <th>Location</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                {% for job in all_jobs %}
                    {% if job.executor == null or job.executor.id != request.session.user_id %}
                    <!-- if nobody does this job or other user doing this job -->
                    <tr>
                        <td>{{ job.created_at|date:"SHORT_DATE_FORMAT" }}</td>
                        <td>{{ job.title }}</td>
                        <td>{{ job.location }}</td>

                        <td>
                            <a href="view/{{job.id}}">View |</a>  
                            {% if job.poster.id == request.session.user_id %}
                                <a href="remove_job/{{job.id}}">Remove |</a>  
                                <a href="edit_job/{{job.id}}">Edit |</a> 
                            {% endif %}
                            {%if job.executor.id == null %}
                                <a href="add_job/{{job.id}}">Add</a>
                            {% endif %}
                        </td>          
                    </tr>
                    {% endif %}                       
                {% endfor %}
            </tbody>
        </table>

        <hr>

        <h3 class="mt-5">Our Users</h3>
        <table class="table table-bordered mt-1">
            <thead class="thead-dark">
                <tr>
                    <th>User</th>
                    <th>Birthdate</th>
                    <th>Posted jobs</th>
                </tr>
            </thead>
            <tbody>
                {% for user in users %}
                <tr>
                    <td>{{ user.first_name }} {{user.last_name}}</td>
                    <td>{{ user.birth_date|date:"SHORT_DATE_FORMAT" }}</td>
                    <td>{{ user.poster.count }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    




    {% include 'footer.html' %}
    <script src="https://unpkg.com/ionicons@5.0.0/dist/ionicons.js"></script>
</body>
</html>


















































